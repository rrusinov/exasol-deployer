{
  "workflow_name": "failsafety",
  "description": "Comprehensive failsafety testing with node failures and recovery",
  "steps": [
    {
      "step": "init"
    },
    {
      "step": "deploy"
    },
    {
      "step": "validate",
      "description": "Validate initial deployment",
      "checks": [
        "cluster_status",
        "ssh_connectivity",
        "database_running",
        "admin_ui_accessible"
      ]
    },
    {
      "step": "stop_cluster"
    },
    {
      "step": "validate",
      "description": "Validate cluster stopped",
      "checks": [
        "cluster_status_stopped",
        "vms_powered_off"
      ]
    },
    {
      "step": "start_cluster"
    },
    {
      "step": "validate",
      "description": "Validate cluster restarted",
      "checks": [
        "cluster_status",
        "ssh_connectivity",
        "database_running",
        "admin_ui_accessible",
        "data_integrity"
      ]
    },
    {
      "step": "restart_node",
      "description": "Restart single node n12",
      "target_node": "n12",
      "method": "ssh"
    },
    {
      "step": "validate",
      "description": "Validate after node restart",
      "checks": [
        "cluster_status",
        "node_status:n12",
        "database_running"
      ]
    },
    {
      "step": "crash_node",
      "description": "Simulate crash on n11",
      "target_node": "n11",
      "method": "ssh"
    },
    {
      "step": "validate",
      "description": "Validate cluster with crashed node",
      "checks": [
        "cluster_degraded",
        "database_degraded"
      ],
      "allow_failures": [
        "database_degraded"
      ]
    },
    {
      "step": "start_node",
      "description": "Recover n11",
      "target_node": "n11"
    },
    {
      "step": "validate",
      "description": "Validate cluster recovered",
      "checks": [
        "all_nodes_running",
        "database_running"
      ],
      "retry": {
        "max_attempts": 5,
        "delay_seconds": 30
      }
    }
  ]
}
